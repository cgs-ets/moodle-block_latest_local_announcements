{"version":3,"sources":["../src/content.js"],"names":["define","$","Log","Ajax","toggleAuditingMode","button","userid","addClass","value","hasClass","debug","call","methodname","args","preferences","done","location","reload","init","error","rootel","first","length","on","e","preventDefault"],"mappings":"AAqBAA,OAAM,4CAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,WAAvB,CAAD,CAAsC,SAASC,CAAT,CAAYC,CAAZ,CAAiBC,CAAjB,CAAuB,CAC/D,aAOA,QAASC,CAAAA,CAAT,CAA4BC,CAA5B,CAAoCC,CAApC,CAA4C,CACxCD,CAAM,CAACE,QAAP,CAAgB,SAAhB,EAEA,GAAIC,CAAAA,CAAK,CAAGH,CAAM,CAACI,QAAP,CAAgB,iBAAhB,EAAqC,CAArC,CAAyC,CAArD,CACAP,CAAG,CAACQ,KAAJ,CAAU,6CAA+CF,CAAzD,EAMAL,CAAI,CAACQ,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,gCADL,CAEPC,IAAI,CAAE,CAAEC,WAAW,CAPL,CAAC,CACf,KAAQ,kCADO,CAEf,MAASN,CAFM,CAGf,OAAUF,CAHK,CAAD,CAOR,CAFC,CAGPS,IAAI,CAAE,eAAmB,CACrBC,QAAQ,CAACC,MAAT,EACH,CALM,CAAD,CAAV,CAOH,CAED,MAAO,CACHC,IAAI,CAAE,cAASZ,CAAT,CAAiB,CAEnB,GAAI,CAACA,CAAL,CAAa,CACTJ,CAAG,CAACiB,KAAJ,CAAU,wDAAV,EACA,MACH,CAED,GAAIC,CAAAA,CAAM,CAAGnB,CAAC,CAAC,mCAAD,CAAD,CAAuCoB,KAAvC,EAAb,CACA,GAAI,CAACD,CAAM,CAACE,MAAZ,CAAoB,CAChBpB,CAAG,CAACiB,KAAJ,CAAU,2DAAV,EACA,MACH,CAGDC,CAAM,CAACG,EAAP,CAAU,OAAV,CAAmB,gBAAnB,CAAqC,SAASC,CAAT,CAAY,CAC7CA,CAAC,CAACC,cAAF,GACA,GAAIpB,CAAAA,CAAM,CAAGJ,CAAC,CAAC,IAAD,CAAd,CACAG,CAAkB,CAACC,CAAD,CAASC,CAAT,CACrB,CAJD,CAKH,CApBE,CAsBV,CAjDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * @package   block_latest_local_announcements\r\n * @copyright 2020 Michael Vangelovski <michael.vangelovski@hotmail.com>\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(['jquery', 'core/log', 'core/ajax'], function($, Log, Ajax) {\r\n    \"use strict\";\r\n\r\n    /**\r\n     * Click handler to toggle auditing mode.\r\n     * @param {Object} button The jquery object.\r\n     * @param int the user id.\r\n     */\r\n    function toggleAuditingMode(button, userid) {\r\n        button.addClass('loading');\r\n        // Save toggle state as a preference.\r\n        var value = button.hasClass('auditing-is-off') ? 1 : 0;\r\n        Log.debug('block_latest_local_announcements: Setting ' + value);\r\n        var preferences = [{\r\n            'name': 'local_announcements_auditingmode',\r\n            'value': value,\r\n            'userid': userid\r\n        }];\r\n        Ajax.call([{\r\n            methodname: 'core_user_set_user_preferences',\r\n            args: { preferences: preferences },\r\n            done: function(response) {\r\n                location.reload();\r\n            }\r\n        }]);\r\n    }\r\n\r\n    return {\r\n        init: function(userid) {\r\n\r\n            if (!userid) {\r\n                Log.error('block_latest_local_announcements: userid not provided!');\r\n                return;\r\n            }\r\n\r\n            var rootel = $('.block_latest_local_announcements').first();\r\n            if (!rootel.length) {\r\n                Log.error('block_latest_local_announcements: root element not found!');\r\n                return;\r\n            }\r\n\r\n            // Handle turn off audit mode button.\r\n            rootel.on('click', '.auditing-icon', function(e) {\r\n                e.preventDefault();\r\n                var button = $(this);\r\n                toggleAuditingMode(button, userid);\r\n            });\r\n        }\r\n    };\r\n});"],"file":"content.min.js"}